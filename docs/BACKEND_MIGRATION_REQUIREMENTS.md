# 백엔드 이전 필수 기능 목록

본 문서는 AX2 Caption 시스템의 프론트엔드(LocalStorage 기반)에서 백엔드 서버로 반드시 이전되어야 하는 기능들을 정리한 것입니다.

---

## 1. 인증/사용자

### 1.1 사용자 계정 관리
- **현재 상태**: LocalStorage에 `users`, `currentUser`, `isLoggedIn` 저장
- **이전 필요 기능**:
  - ✅ 사용자 회원가입 (이메일 기반)
    - 이메일, 비밀번호, 이름 저장
    - 중복 이메일 검증
    - 비밀번호 해싱 (bcrypt 등)
  - ✅ 사용자 로그인/로그아웃
    - 이메일/비밀번호 인증
    - JWT 토큰 발급 및 관리
    - 세션 관리
  - ✅ 사용자 정보 조회/수정
    - 프로필 정보 (이름, 이메일, 프로필 사진)
    - 계정 설정 변경
  - ✅ 사용자 탈퇴
    - 계정 삭제 및 관련 데이터 정리

### 1.2 소셜 로그인 연동
- **현재 상태**: Google, Kakao, Naver OAuth 2.0 클라이언트 사이드 처리
- **이전 필요 기능**:
  - ✅ 소셜 로그인 백엔드 인증 처리
    - OAuth 2.0 서버 사이드 콜백 처리
    - 소셜 제공자로부터 받은 토큰 검증
    - 사용자 정보 조회 및 DB 저장
    - 통합 사용자 계정 관리 (이메일/소셜 통합)
  - ✅ 소셜 계정 연동/해제
    - 여러 소셜 계정을 하나의 계정에 연결
    - 소셜 계정 연결 해제

### 1.3 사용자 세션 관리
- **현재 상태**: LocalStorage에 `isLoggedIn`, `currentUser` 저장
- **이전 필요 기능**:
  - ✅ 세션 토큰 관리
    - JWT Access Token / Refresh Token 발급
    - 토큰 만료 시간 관리
    - 토큰 갱신 (Refresh Token)
  - ✅ 자동 로그인
    - Refresh Token 기반 자동 로그인
    - 세션 유지 관리

---

## 2. 영상 업로드/파일 처리

### 2.1 파일 업로드
- **현재 상태**: 
  - 브라우저 메모리에 Blob URL로 저장 (`URL.createObjectURL`)
  - IndexedDB에 파일 저장
  - LocalStorage에 메타데이터만 저장 (`savedVideos`)
- **이전 필요 기능**:
  - ✅ 파일 업로드 API
    - 멀티파트 업로드 지원 (대용량 파일)
    - 업로드 진행률 추적
    - 파일 크기 제한 검증 (최대 2GB)
    - 파일 형식 검증 (MP4, MOV, AVI, WEBM)
  - ✅ 파일 스토리지 관리
    - 클라우드 스토리지 연동 (AWS S3, Google Cloud Storage 등)
    - 파일 저장 및 스트리밍 URL 생성
    - 파일 접근 권한 관리 (사용자별)
  - ✅ 파일 메타데이터 저장
    - 파일명, 크기, 형식, 업로드 시간
    - 영상 길이 (duration) 추출 및 저장
    - 썸네일 생성 및 저장

### 2.2 파일 관리
- **현재 상태**: LocalStorage에 비디오 데이터 저장
- **이전 필요 기능**:
  - ✅ 파일 목록 조회
    - 사용자별 업로드된 파일 목록
    - 페이지네이션 지원
    - 정렬 및 필터링 (날짜, 제목, 상태 등)
  - ✅ 파일 삭제
    - 스토리지에서 파일 삭제
    - 관련 자막 데이터 삭제
    - 작업 이력 삭제
  - ✅ 파일 다운로드
    - 원본 영상 파일 다운로드
    - 스트리밍 지원

### 2.3 자동 삭제 스케줄링
- **현재 상태**: LocalStorage 기반으로 만료 시간 저장 (`expiresAt`)
- **이전 필요 기능**:
  - ✅ 자동 삭제 스케줄러
    - 처리 완료 후 2시간 뒤 자동 삭제 (기본)
    - 보관 기간 연장 옵션 (7일, 30일, 90일)
    - 백그라운드 작업으로 만료된 파일 정리
    - 사용자별 보관 정책 적용

---

## 3. 자막 생성 작업(Job)

### 3.1 작업 생성 및 관리
- **현재 상태**: LocalStorage에 `jobs`, `videoJobs` 저장
- **이전 필요 기능**:
  - ✅ 작업 생성 API
    - 비디오 ID, 언어 설정, 크레딧 정보로 작업 생성
    - 작업 ID 발급 및 상태 관리
    - 작업 큐 시스템 (Redis, RabbitMQ 등)
  - ✅ 작업 상태 관리
    - 상태: `pending`, `processing`, `completed`, `failed`
    - 작업 진행률 추적 (0-100%)
    - 작업 실패 시 재시도 로직
  - ✅ 작업 조회
    - 사용자별 작업 목록
    - 작업 상세 정보 조회
    - 작업 상태 실시간 업데이트 (WebSocket 또는 Polling)

### 3.2 AI 음성 인식 처리
- **현재 상태**: 프론트엔드에서 모의 처리 (실제 AI 없음)
- **이전 필요 기능**:
  - ✅ 음성 인식 API 연동
    - Google Speech-to-Text, AWS Transcribe 등
    - 다국어 음성 인식 (100개 이상 언어)
    - 언어 자동 감지
    - 화자 분리 (speaker diarization)
  - ✅ 자막 생성 파이프라인
    - 음성 → 텍스트 변환
    - 시간 동기화 (타임스탬프)
    - 자막 세그먼트 생성
    - 정확도 검증

### 3.3 번역 처리
- **현재 상태**: 프론트엔드에서 모의 처리
- **이전 필요 기능**:
  - ✅ 번역 API 연동
    - Google Translate, DeepL 등
    - 다국어 번역 지원
    - 원본 언어 → 타겟 언어 번역
    - 번역 품질 검증

### 3.4 작업 진행률 추적
- **현재 상태**: 프론트엔드에서 모의 진행률 표시
- **이전 필요 기능**:
  - ✅ 실시간 진행률 업데이트
    - WebSocket 또는 Server-Sent Events (SSE)
    - 단계별 진행률 (업로드, 음성 인식, 번역, 저장)
    - 에러 발생 시 즉시 알림

---

## 4. 자막 데이터

### 4.1 자막 저장 및 관리
- **현재 상태**: LocalStorage에 `savedVideos` 배열에 자막 데이터 포함
- **이전 필요 기능**:
  - ✅ 자막 데이터 저장
    - 원본 자막 (transcription)
    - 번역 자막 (translation)
    - 타임스탬프 정보
    - 화자 정보 (speaker)
    - 언어 정보 (originalLang, targetLanguages)
  - ✅ 자막 조회
    - 비디오별 자막 조회
    - 언어별 자막 조회
    - 자막 버전 관리 (편집 이력)
  - ✅ 자막 수정/삭제
    - 자막 텍스트 수정
    - 자막 시간 조정
    - 자막 세그먼트 분할/병합
    - 변경 이력 저장

### 4.2 자막 편집 기능
- **현재 상태**: 프론트엔드에서 `edit.js`로 편집, LocalStorage에 저장
- **이전 필요 기능**:
  - ✅ 자막 편집 API
    - 자막 텍스트 수정
    - 시작/종료 시간 조정
    - 자막 분할/병합
    - 자막 스타일 설정 저장 (폰트, 색상, 위치 등)
  - ✅ 편집 이력 관리
    - 변경 이력 저장
    - 되돌리기/다시하기 기능
    - 버전 관리

### 4.3 자막 내보내기
- **현재 상태**: 프론트엔드에서 SRT, VTT, ASS 형식으로 변환하여 다운로드
- **이전 필요 기능**:
  - ✅ 자막 파일 생성 API
    - SRT, VTT, ASS 형식 변환
    - 다국어 자막 파일 생성
    - 파일 다운로드 제공
  - ✅ 자막 미리보기
    - 비디오 플레이어와 함께 자막 오버레이 표시
    - 실시간 미리보기 지원

---

## 5. 크레딧/결제

### 5.1 크레딧 관리
- **현재 상태**: 
  - LocalStorage에 `creditBalance` (로그인), `freeCreditBalance` (비로그인) 저장
  - `creditReservations` 예약 내역 저장
- **이전 필요 기능**:
  - ✅ 크레딧 잔액 관리
    - 사용자별 크레딧 잔액 저장 (DB)
    - 크레딧 조회 API
    - 크레딧 잔액 실시간 동기화
  - ✅ 크레딧 계산
    - 영상 길이 기반 크레딧 계산 (분당 10 크레딧)
    - 번역 언어별 추가 크레딧 (언어당 분당 5 크레딧)
    - 크레딧 예약 시스템 (선차감)
  - ✅ 크레딧 차감/환불
    - 작업 시작 시 크레딧 예약 및 차감
    - 작업 실패 시 크레딧 환불
    - 작업 완료 시 크레딧 확정 차감
  - ✅ 무료 크레딧 관리
    - 비로그인 사용자 무료 크레딧 제공
    - IP 기반 또는 디바이스 기반 제한
    - 무료 크레딧 사용량 추적

### 5.2 크레딧 충전
- **현재 상태**: LocalStorage에 `totalCharged`, `creditHistory`, `paymentHistory` 저장
- **이전 필요 기능**:
  - ✅ 결제 시스템 연동
    - 결제 게이트웨이 연동 (PG사: 토스페이먼츠, 이니시스, 아임포트 등)
    - 결제 요청 및 승인 처리
    - 결제 내역 저장
  - ✅ 크레딧 충전 패키지 관리
    - 패키지 정보 관리 (크레딧 수량, 가격, 보너스)
    - 프로모션 및 할인 적용
  - ✅ 크레딧 충전 내역
    - 충전 내역 조회
    - 영수증 발급
    - 환불 처리

### 5.3 크레딧 사용 내역
- **현재 상태**: LocalStorage에 `creditHistory` 저장
- **이전 필요 기능**:
  - ✅ 크레딧 사용 내역 조회
    - 사용 내역 목록 (충전, 사용, 환불)
    - 기간별 필터링
    - 통계 정보 (월별 사용량 등)
  - ✅ 크레딧 알림
    - 크레딧 부족 알림
    - 충전 완료 알림

---

## 6. 로그/이력

### 6.1 사용자 활동 로그
- **현재 상태**: LocalStorage 기반, 제한적 로깅
- **이전 필요 기능**:
  - ✅ 활동 로그 저장
    - 로그인/로그아웃 이력
    - 파일 업로드 이력
    - 자막 생성 요청 이력
    - 자막 편집 이력
    - 파일 다운로드 이력
    - 크레딧 사용 이력
  - ✅ 로그 조회
    - 사용자별 활동 로그 조회
    - 기간별 필터링
    - 검색 기능

### 6.2 작업 이력 관리
- **현재 상태**: LocalStorage에 `videoJobs`, `savedVideos` 저장
- **이전 필요 기능**:
  - ✅ 작업 이력 저장
    - 작업 생성 시간, 완료 시간
    - 작업 상태 변경 이력
    - 작업 실패 원인 로깅
  - ✅ 작업 이력 조회
    - 사용자별 작업 목록
    - 상태별 필터링 (처리 중, 완료, 실패)
    - 검색 기능 (제목, 날짜 등)

### 6.3 에러 로깅 및 모니터링
- **현재 상태**: 브라우저 콘솔 로깅
- **이전 필요 기능**:
  - ✅ 에러 로깅
    - 서버 사이드 에러 로깅
    - 클라이언트 에러 수집 (Sentry 등)
    - 에러 분류 및 우선순위 관리
  - ✅ 시스템 모니터링
    - API 응답 시간 모니터링
    - 작업 처리 시간 통계
    - 시스템 리소스 사용량 모니터링
    - 알림 시스템 (에러 발생 시)

### 6.4 감사 로그 (Audit Log)
- **현재 상태**: 없음
- **이전 필요 기능**:
  - ✅ 보안 감사 로그
    - 인증 시도 실패 로그
    - 권한 변경 로그
    - 중요 데이터 접근 로그
    - 의심스러운 활동 감지

---

## 요약

### 우선순위 높음 (핵심 기능)
1. **인증/사용자**: 사용자 계정 관리, 소셜 로그인, 세션 관리
2. **영상 업로드/파일 처리**: 파일 업로드, 스토리지 관리, 자동 삭제
3. **자막 생성 작업**: 작업 관리, AI 음성 인식 연동, 진행률 추적
4. **크레딧/결제**: 크레딧 관리, 결제 연동, 사용 내역

### 우선순위 중간
5. **자막 데이터**: 자막 저장/조회, 편집 API, 내보내기
6. **로그/이력**: 활동 로그, 작업 이력, 에러 로깅

### 기술 스택 권장사항
- **백엔드 프레임워크**: Node.js (Express), Python (FastAPI/Django), 또는 Go
- **데이터베이스**: PostgreSQL (사용자, 작업, 자막), MongoDB (로그)
- **파일 스토리지**: AWS S3, Google Cloud Storage
- **작업 큐**: Redis + Bull/BullMQ, RabbitMQ
- **실시간 통신**: WebSocket (Socket.io), Server-Sent Events
- **AI 서비스**: Google Speech-to-Text, AWS Transcribe, Google Translate
- **결제**: 토스페이먼츠, 이니시스, 아임포트
- **모니터링**: Sentry, DataDog, CloudWatch

---

**작성일**: 2025년 1월  
**기준 문서**: SYSTEM_OVERVIEW.md

